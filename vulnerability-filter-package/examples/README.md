# Examples for Aqua Vulnerability Filter

This directory contains example scripts to demonstrate the Aqua Vulnerability Filter's capabilities.

## Directory Structure

- `input/` - Place your Aqua scan reports here
- `output/` - Filtered reports will be saved here
- `previous/` - Optional directory for storing previous scans (for delta reporting)

## Ignoring Vulnerabilities

The script `run_filtering.sh` demonstrates how to filter ignored vulnerabilities from Aqua Security scan reports.

```bash
chmod +x run_filtering.sh
./run_filtering.sh
```

## Splunk Integration

The script `splunk_integration.sh` shows how to filter Aqua scan results for optimal Splunk ingestion.

```bash
chmod +x splunk_integration.sh
./splunk_integration.sh
```

This will:
1. Filter vulnerabilities based on severity (CVSS ≥ 7.0)
2. Compare with previous scan for delta reporting (if available)
3. Create a Splunk-optimized events file
4. Provide instructions for sending data to Splunk

## Required Files

For both examples to work, place the following files in the `input/` directory:

- `aqua-scan.json` - The JSON report from Aqua Security
- `aqua-scan.html` - (Optional) The HTML report from Aqua Security
- `styles.css` - (Optional) CSS file for the HTML report

For delta reporting (to only identify new vulnerabilities), place a previous scan report at:

- `previous/aqua-scan.json`

## Results

After running the examples, you'll find the filtered results in the `output/` directory:

### Ignored Vulnerability Filtering

- `aqua-scan-filtered.json` - JSON report with ignored vulnerabilities removed
- `aqua-scan-filtered.html` - HTML report with ignored vulnerabilities removed

### Splunk Integration

- `filtered-for-splunk.json` - Complete filtered report
- `filtered-for-splunk_splunk.json` - Splunk-optimized line-by-line events
- `filtered-for-splunk_summary.json` - Summary of filtering results

## License

Copyright © 2024 