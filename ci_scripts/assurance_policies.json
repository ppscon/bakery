[
  {
    "assurance_type": "kubernetes",
    "id": 12,
    "name": "operator-k8s-control",
    "description": "",
    "author": "philip.pearson+slim1731598076@aquasec.com",
    "lastupdate": "2025-02-16T15:08:58.091329Z",
    "cvss_severity_enabled": false,
    "cvss_severity": "",
    "custom_severity_enabled": false,
    "custom_severity": "",
    "vulnerability_exploitability": false,
    "disallow_exploit_types": [],
    "cvss_severity_exclude_no_fix": false,
    "maximum_score_enabled": false,
    "maximum_score": 0,
    "maximum_score_exclude_no_fix": false,
    "custom_checks_enabled": false,
    "scap_enabled": false,
    "cves_black_list_enabled": false,
    "cves_white_list_enabled": false,
    "packages_black_list_enabled": false,
    "packages_white_list_enabled": false,
    "only_none_root_users": false,
    "trusted_base_images_enabled": false,
    "scan_sensitive_data": false,
    "audit_on_failure": true,
    "fail_cicd": false,
    "block_failed": true,
    "blacklisted_licenses_enabled": false,
    "blacklisted_licenses": [],
    "whitelisted_licenses_enabled": false,
    "whitelisted_licenses": [],
    "custom_checks": [],
    "scap_files": [],
    "scope": {
      "expression": "v1",
      "variables": [
        {
          "attribute": "kubernetes.cluster",
          "value": "*"
        }
      ]
    },
    "registries": [],
    "labels": [],
    "images": [],
    "cves_black_list": [],
    "cves_white_list": [],
    "packages_black_list": [],
    "packages_white_list": [],
    "allowed_images": [],
    "trusted_base_images": [],
    "read_only": false,
    "force_microenforcer": false,
    "partial_results_image_fail": false,
    "control_exclude_no_fix": false,
    "ignore_recently_published_vln": false,
    "ignore_recently_published_vln_period": 0,
    "ignore_recently_published_fix_vln": false,
    "ignore_recently_published_fix_vln_period": 0,
    "FFMap": null,
    "ignore_risk_resources_enabled": false,
    "ignore_base_image_vln": false,
    "ignored_risk_resources": [],
    "ignored_sensitive_resources": [],
    "permission": "Write",
    "dta_severity": "",
    "dta_enabled": false,
    "disallow_malware": false,
    "monitored_malware_paths": [],
    "exceptional_monitored_malware_paths": [],
    "scan_malware_in_archives": false,
    "malware_action": "",
    "scan_nfs_mounts": false,
    "required_labels_enabled": false,
    "required_labels": [],
    "kubernetes_controls": [
      {
        "script_id": 89,
        "name": "Access to host IPC namespace",
        "description": "Sharing the host’s IPC namespace allows container processes to communicate with processes on the host.",
        "enabled": true,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0008"
      },
      {
        "script_id": 91,
        "name": "Access to host network",
        "description": "Sharing the host’s network namespace permits processes in the pod to communicate with processes bound to the host’s loopback adapter.",
        "enabled": true,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0009"
      },
      {
        "script_id": 90,
        "name": "Access to host PID",
        "description": "Sharing the host’s PID namespace allows visibility on host processes, potentially leaking information such as environment variables and configuration.",
        "enabled": true,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0010"
      },
      {
        "script_id": 129,
        "name": "Access to host ports",
        "description": "According to pod security standard 'Host Ports', hostPorts should be disallowed, or at minimum restricted to a known list.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0024"
      },
      {
        "script_id": 88,
        "name": "Access to host process",
        "description": "Windows hostprocess container permits processes in the pod to access the host's network interfaces and IP addresses",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0103"
      },
      {
        "script_id": 134,
        "name": "All container images must start with a GCR domain",
        "description": "Containers should only use images from trusted GCR registries.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0033"
      },
      {
        "script_id": 133,
        "name": "All container images must start with an ECR domain",
        "description": "Containers should only use images from trusted registries.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0035"
      },
      {
        "script_id": 132,
        "name": "All container images must start with the *.azurecr.io domain",
        "description": "Containers should only use images from trusted registries.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0032"
      },
      {
        "script_id": 94,
        "name": "Anonymous user access binding",
        "description": "Binding to anonymous user to any clusterrole or role is a security risk",
        "enabled": true,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0122"
      },
      {
        "script_id": 93,
        "name": "Can elevate its own privileges",
        "description": "A program inside the container can elevate its own privileges and run as root, which might give the program control over the container and node.",
        "enabled": true,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0001"
      },
      {
        "script_id": 96,
        "name": "ConfigMap with secrets",
        "description": "Storing secrets in configMaps is unsafe",
        "enabled": true,
        "severity": "high",
        "kind": "configmap",
        "ootb": true,
        "avd_id": "AVD-KSV-0109"
      },
      {
        "script_id": 97,
        "name": "ConfigMap with sensitive content",
        "description": "Storing sensitive content such as usernames and email addresses in configMaps is unsafe",
        "enabled": false,
        "severity": "medium",
        "kind": "configmap",
        "ootb": true,
        "avd_id": "AVD-KSV-01010"
      },
      {
        "script_id": 138,
        "name": "Container images from public registries used",
        "description": "Container images must not start with an empty prefix or a defined public registry domain.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0034"
      },
      {
        "script_id": 83,
        "name": "CPU not limited",
        "description": "Enforcing CPU limits prevents DoS via resource exhaustion.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0011"
      },
      {
        "script_id": 84,
        "name": "CPU requests not specified",
        "description": "When containers have resource requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0015"
      },
      {
        "script_id": 100,
        "name": "Default capabilities: some containers do not drop all",
        "description": "The container should drop all default capabilities and add only those that are needed for its execution.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0003"
      },
      {
        "script_id": 135,
        "name": "Default capabilities: some containers do not drop any",
        "description": "Security best practices require containers to run with minimal required capabilities.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0004"
      },
      {
        "script_id": 98,
        "name": "Default security context configured",
        "description": "Security context controls the allocation of security parameters for the pod/container/volume, ensuring the appropriate level of protection. Relying on default security context may expose vulnerabilities to potential attacks that rely on privileged access.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0118"
      },
      {
        "script_id": 99,
        "name": "Delete pod logs",
        "description": "Used to cover attacker’s tracks, but most clusters ship logs quickly off-cluster.",
        "enabled": false,
        "severity": "medium",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0042"
      },
      {
        "script_id": 101,
        "name": "Exec into Pods",
        "description": "The ability to exec into a container with privileged access to the host or with an attached SA with higher RBAC permissions is a common escalation path to cluster-admin.",
        "enabled": false,
        "severity": "high",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0053"
      },
      {
        "script_id": 119,
        "name": "hostPath volume mounted with docker.sock",
        "description": "Mounting docker.sock from the host can give the container full root access to the host.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0006"
      },
      {
        "script_id": 103,
        "name": "hostPath volumes mounted",
        "description": "According to pod security standard 'HostPath Volumes', HostPath volumes must be forbidden.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0023"
      },
      {
        "script_id": 137,
        "name": "Image tag \":latest\" used",
        "description": "It is best to avoid using the ':latest' image tag when deploying containers in production. Doing so makes it hard to track which version of the image is running, and hard to roll back the version.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0013"
      },
      {
        "script_id": 105,
        "name": "Kubernetes resource with disallowed volumes mounted",
        "description": "HostPath present many security risks and as a security practice it is better to avoid critical host paths mounts.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0121"
      },
      {
        "script_id": 107,
        "name": "Manage all resources",
        "description": "Full control of the cluster resources, and therefore also “root” on all nodes where workloads can run and has access to all pods, secrets, and data.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0046"
      },
      {
        "script_id": 106,
        "name": "Manage all resources at the namespace",
        "description": "Full control of the resources within a namespace.  In some cluster configurations, this is excessive. In others, this is normal (a gitops deployment operator like flux)",
        "enabled": false,
        "severity": "high",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0112"
      },
      {
        "script_id": 108,
        "name": "Manage configmaps",
        "description": "Some workloads leverage configmaps to store sensitive data or configuration parameters that affect runtime behavior that can be modified by an attacker or combined with another issue to potentially lead to compromise.",
        "enabled": true,
        "severity": "medium",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0049"
      },
      {
        "script_id": 109,
        "name": "Manage EKS IAM Auth ConfigMap",
        "description": "Ability to add AWS IAM to RBAC bindings via special EKS configmap.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0115"
      },
      {
        "script_id": 110,
        "name": "Manage Kubernetes networking",
        "description": "The ability to control which pods get service traffic directed to them allows for interception attacks. Controlling network policy allows for bypassing lateral movement restrictions.",
        "enabled": false,
        "severity": "high",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0056"
      },
      {
        "script_id": 111,
        "name": "Manage Kubernetes RBAC resources",
        "description": "An effective level of access equivalent to cluster-admin.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0050"
      },
      {
        "script_id": 112,
        "name": "Manage Kubernetes workloads and pods",
        "description": "Depending on the policies enforced by the admission controller, this permission ranges from the ability to steal compute (crypto) by running workloads or allowing for creating workloads that escape to the node as root and escalation to cluster-admin.",
        "enabled": false,
        "severity": "medium",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0048"
      },
      {
        "script_id": 113,
        "name": "Manage namespace secrets",
        "description": "Viewing secrets at the namespace scope can lead to escalation if another service account in that namespace has a higher privileged rolebinding or clusterrolebinding bound.",
        "enabled": false,
        "severity": "medium",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0113"
      },
      {
        "script_id": 114,
        "name": "Manage secrets",
        "description": "Viewing secrets at the cluster-scope is akin to cluster-admin in most clusters as there are typically at least one service accounts (their token stored in a secret) bound to cluster-admin directly or a role/clusterrole that gives similar permissions.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0041"
      },
      {
        "script_id": 116,
        "name": "Manages /etc/hosts",
        "description": "Managing /etc/hosts aliases can prevent the container engine from modifying the file after a pod’s containers have already been started.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0007"
      },
      {
        "script_id": 115,
        "name": "Manage webhookconfigurations",
        "description": "Webhooks can silently intercept or actively mutate/block resources as they are being created or updated. This includes secrets and pod specs.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0114"
      },
      {
        "script_id": 117,
        "name": "Memory not limited",
        "description": "Enforcing memory limits prevents DoS via resource exhaustion.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0018"
      },
      {
        "script_id": 118,
        "name": "Memory requests not specified",
        "description": "When containers have memory requests specified, the scheduler can make better decisions about which nodes to place pods on, and how to deal with resource contention.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0016"
      },
      {
        "script_id": 85,
        "name": "NET_RAW capability added",
        "description": "The NET_RAW capability grants attackers the ability to eavesdrop on network traffic or generate IP traffic with falsified source addresses, posing serious security risks.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0119"
      },
      {
        "script_id": 128,
        "name": "Non-core volume types used.",
        "description": "According to pod security standard 'Volume types', non-core volume types must not be used.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0028"
      },
      {
        "script_id": 130,
        "name": "Non-default /proc masks set",
        "description": "According to pod security standard '/proc Mount Type', the default /proc masks are set up to reduce attack surface, and should be required.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0027"
      },
      {
        "script_id": 120,
        "name": "Prevent binding to privileged ports",
        "description": "The ports which are lower than 1024 receive and transmit various sensitive and privileged data. Allowing containers to use them can bring serious implications.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0117"
      },
      {
        "script_id": 104,
        "name": "Privileged",
        "description": "Privileged containers share namespaces with the host system and do not offer any security. They should be used exclusively for system containers that require high privileges.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0017"
      },
      {
        "script_id": 102,
        "name": "Root file system is not read-only",
        "description": "An immutable root file system prevents applications from writing to their local disk. This can limit intrusions, as attackers will not be able to tamper with the file system or write foreign executables to disk.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0014"
      },
      {
        "script_id": 121,
        "name": "Runs as root user",
        "description": "Force the running image to run as a non-root user to ensure least privileges.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0012"
      },
      {
        "script_id": 122,
        "name": "Runs with GID <= 10000",
        "description": "Force the container to run with group ID > 10000 to avoid conflicts with the host’s user table.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0021"
      },
      {
        "script_id": 123,
        "name": "Runs with UID <= 10000",
        "description": "Force the container to run with user ID > 10000 to avoid conflicts with the host’s user table.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0020"
      },
      {
        "script_id": 95,
        "name": "Runtime/Default AppArmor profile not set",
        "description": "According to pod security standard 'AppArmor', the AppArmor key must be set to the runtime/default profile or to be undefined.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0002"
      },
      {
        "script_id": 126,
        "name": "Runtime/Default Seccomp profile not set",
        "description": "According to pod security standard 'Seccomp', the RuntimeDefault seccomp profile must be required, or allow specific additional profiles.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0030"
      },
      {
        "script_id": 124,
        "name": "Seccomp policies disabled",
        "description": "A program inside the container can bypass Seccomp protection policies.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0104"
      },
      {
        "script_id": 131,
        "name": "SELinux custom options set",
        "description": "According to pod security standard 'SElinux', setting custom SELinux options should be disallowed.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0025"
      },
      {
        "script_id": 125,
        "name": "Service with External IP",
        "description": "Services with external IP addresses allows direct access from the internet and might expose risk for CVE-2020-8554",
        "enabled": false,
        "severity": "high",
        "kind": "service",
        "ootb": true,
        "avd_id": "AVD-KSV-0108"
      },
      {
        "script_id": 92,
        "name": "Specific capabilities added",
        "description": "According to pod security standard 'Capabilities', capabilities beyond the default set must not be added.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0022"
      },
      {
        "script_id": 86,
        "name": "SYS_ADMIN capability added",
        "description": "SYS_ADMIN gives the processes running inside the container privileges that are equivalent to root.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0005"
      },
      {
        "script_id": 87,
        "name": "SYS_MODULE capability added",
        "description": "The SYS_MODULE capability grants attackers the ability to install and remove kernel modules, posing serious security risks.",
        "enabled": false,
        "severity": "high",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0120"
      },
      {
        "script_id": 127,
        "name": "Unsafe sysctl options set",
        "description": "Sysctls can disable security mechanisms or affect all containers on a host, and should be disallowed except for an allowed 'safe' subset. A sysctl is considered safe if it is namespaced in the container or the pod, and is isolated from other pods and processes on the same node.",
        "enabled": false,
        "severity": "medium",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0026"
      },
      {
        "script_id": 136,
        "name": "User with admin access",
        "description": "Either cluster-admin or those granted powerful permissions.",
        "enabled": false,
        "severity": "critical",
        "kind": "roleandrolebinding",
        "ootb": true,
        "avd_id": "AVD-KSV-0111"
      },
      {
        "script_id": 139,
        "name": "Workloads in the default namespace",
        "description": "Checks whether a workload is running in the default namespace.",
        "enabled": false,
        "severity": "low",
        "kind": "workload",
        "ootb": true,
        "avd_id": "AVD-KSV-0110"
      }
    ],
    "kubernetes_controls_names": [
      "Access to host IPC namespace",
      "Access to host network",
      "Access to host PID",
      "Anonymous user access binding",
      "Can elevate its own privileges",
      "ConfigMap with secrets",
      "Manage configmaps"
    ],
    "kubernetes_controls_avd_ids": [
      "AVD-KSV-0008",
      "AVD-KSV-0009",
      "AVD-KSV-0010",
      "AVD-KSV-0122",
      "AVD-KSV-0001",
      "AVD-KSV-0109",
      "AVD-KSV-0049"
    ],
    "forbidden_labels_enabled": false,
    "forbidden_labels": [],
    "scan_windows_registry": false,
    "scan_process_memory": false,
    "policy_settings": {
      "enforce": true,
      "warn": false,
      "warning_message": "",
      "is_audit_checked": false
    },
    "application_scopes": [
      "Global"
    ],
    "exclude_application_scopes": [],
    "docker_cis_enabled": false,
    "kube_cis_enabled": false,
    "enforce_excessive_permissions": false,
    "blacklist_permissions_enabled": false,
    "blacklist_permissions": [],
    "linux_cis_enabled": false,
    "windows_cis_enabled": false,
    "openshift_hardening_enabled": false,
    "function_integrity_enabled": false,
    "auto_scan_enabled": false,
    "auto_scan_configured": false,
    "aggregated_vulnerability": {},
    "vulnerability_score_range": []
  }
]